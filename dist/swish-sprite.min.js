!function(e,t,n){"use strict";var r=function(e,t){this.initialize(e,t)},i=r.prototype,a=null;i._onFocus=null,i._onBlur=null,i._onToggle=null,t.hidden!==n?a="visibilitychange":t.mozHidden!==n?a="mozvisibilitychange":t.msHidden!==n?a="msvisibilitychange":t.webkitHidden!==n&&(a="webkitvisibilitychange"),i.initialize=function(n,r){if(a){this._onBlur=r,this._onFocus=n;var i=function(){t.hidden||t.webkitHidden||t.msHidden||t.mozHidden?r():n()};t.addEventListener(a,i,!1),e.addEventListener("pagehide",r),e.addEventListener("pageshow",n),e.addEventListener("blur",r),e.addEventListener("focus",n),e.addEventListener("visibilitychange",i,!1),this._onToggle=i}},i.destroy=function(){a&&(e.removeEventListener("pagehide",this._onBlur),e.removeEventListener("pageshow",this._onFocus),e.removeEventListener("blur",this._onBlur),e.removeEventListener("focus",this._onFocus),e.addEventListener("visibilitychange",this._onToggle),t.removeEventListener(a,this._onToggle,!1),this._onFocus=null,this._onBlur=null)},namespace("cloudkid").PageVisibility=r}(window,document),function(e,t){"use strict";function n(e){return null===e?String(e):"object"==typeof e||"function"==typeof e?Object.prototype.toString.call(e).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof e}var r=function(){},i=r.prototype;i._listeners=[],i.trigger=function(e,n){if(this._listeners[e]!==t)for(var r=this._listeners[e],i=0;i<r.length;i++)r[i](n)},i.on=function(e,t){if("object"===n(e))for(var r in e)e.hasOwnProperty(r)&&this.on(r,e[r]);else if("function"===n(t))for(var i=e.split(" "),a=null,o=0,s=i.length;s>o;o++)a=i[o],this._listeners[a]=this._listeners[a]||[],-1===this._callbackIndex(a,t)&&this._listeners[a].push(t);else if("array"===n(t))for(var u=0,l=t.length;l>u;u++)this.on(e,t[u]);return this},i.off=function(e,r){if(e===t)this._listeners=[];else if("array"===n(r))for(var i=0,a=r.length;a>i;i++)this.off(e,r[i]);else for(var o=e.split(" "),s=null,u=0,l=o.length;l>u;u++)if(s=o[u],this._listeners[s]=this._listeners[s]||[],r===t)this._listeners[s].length=0;else{var c=this._callbackIndex(s,r);-1!==c&&this._listeners[e].splice(c,1)}return this},i._callbackIndex=function(e,t){for(var n=0,r=this._listeners[e].length;r>n;n++)if(this._listeners[e][n]===t)return n;return-1},namespace("cloudkid").EventDispatcher=r}(window),function(e,t){"use strict";var n=function(e){this.initialize(e)},r=n.prototype=new cloudkid.EventDispatcher,i=null,a=!0,o=!1,s=!1,u=!1,l=!1,c=null,d=null,f=null,h=0,p=null,v=0,g=null,m=null,y=null,E=0,T=!1,L=null,b=null,S=null,P=null,_=null,w=-1,D=null;n.LOAD_STARTED="loadStarted",n.LOADED="loaded",n.LOAD_PROGRESS="loadProgress",n.COMPLETE="complete",n.PROGRESS="progress",n.PAUSED="paused",n.RESUMED="resumed",n.STOPPED="stopped",n.STARTED="started",n.M4A_PADDING=.1,n.VERSION="1.0.6",r.manualUpdate=!1,r.initialize=function(t){var r=cloudkid.AudioUtils;if(!r.supported())throw"HTML5 Audio is not supported!";if(null!==P)throw"SwishSprite instance is already create. Destroy before re-creating";this.clear();var s=null!==t&&"object"==typeof t?r.importSpriteMap(this,t):r.getPlayableURL(t);if(!s)throw"The supplied filetype is unsupported in this browser.";P=this,o=!1,a=!0,l=!1,E=0,T=!1,_=new cloudkid.PageVisibility(M,A),w=-1,v=s.indexOf(".m4a")>-1?n.M4A_PADDING:0,i=e.document.createElement("audio"),i.addEventListener("canplay",k),i.addEventListener("canplaythrough",x),i.addEventListener("loadeddata",k),i.addEventListener("loadedmetadata",k),i.addEventListener("progress",k),i.addEventListener("ended",G),i.addEventListener("stalled",z),i.src=s},r.getAudioElement=function(){return i},r.mute=function(){return i.volume=0,this},r.unmute=function(){return i.volume=1,this},r.pause=function(){u=!1,c&&e.clearInterval(c),f&&e.clearTimeout(f);var t=a;return i.pause(),a=!0,t||this.trigger(n.PAUSED),this},r.resume=function(){return a&&g&&(this.play(g,i.currentTime),this.trigger(n.RESUMED)),this},r.stop=function(){return null!==g&&this.trigger(n.STOPPED),this.pause(),g=null,this},r.getLength=function(e){return e===t&&g!==t?p[g].duration:e!==t?p[e].duration:0},r.getPosition=function(){return g!==t&&p[g]!==t?i.currentTime-p[g].start:0},r.getSound=function(e){return e===t&&g!==t?p[g]:e?p[e]:void 0},r.setSound=function(e,t,n,r){var i=r?0:v;return p[e]={start:t-i,end:t+n+i,duration:n+2*i,loop:r},this},r.prepare=function(e){p[e]!==t&&(i.currentTime=p[e].start)},r.clear=function(){return p={},this},r.load=function(){try{if(d&&e.clearInterval(d),s=!0,this.manualUpdate||(d=e.setInterval(k,10)),p.silence===t)throw"'silence' audio is required";this.play("silence")}catch(n){}return this},r.update=function(){s&&k(),u&&R()},r.play=function(r,o){var s;if(y=0,u=!1,e.clearInterval(c),e.clearTimeout(f),p[r]===t)return Debug.error("SoundUnknown: Sound not found. Playing sound '"+r+"' has failed."),!1;var l=p[r];s=l.start,o!==t&&o>=l.start&&o<l.end&&(s=o);try{m=!1,i.pause(),L=i.currentTime;try{i.currentTime=D=s}catch(d){}if(Math.abs(i.currentTime-s)>.5)return!0;g=r,a=!1,i.play(),P.trigger(n.STARTED);var h=Math.max(0,Math.min((i.currentTime-p[g].start)/p[g].duration,1));P.trigger(n.PROGRESS,h),f=e.setTimeout(I,1e3*p[g].duration+500),u=!0,this.manualUpdate||(c=e.setInterval(R,10))}catch(d){return Debug.error("SoundPlayException: Sound Playback has failed: "+d),!1}return!0};var R=function(){var t,r=p[g];if(!m&&e.Math.abs(i.currentTime-L)>.1)m=!0,L=i.currentTime,f&&e.clearTimeout(f),t=r.end-i.currentTime,e.Math.abs(t-r.duration)>.1&&(t=r.duration),f=e.setTimeout(I,1e3*t+500);else if(T||i.currentTime===L){if(m&&T){if(i.currentTime>D){var a=Math.max(0,Math.min((i.currentTime-r.start)/r.duration,1));P.trigger(n.PROGRESS,a)}D=i.currentTime,i.currentTime>=r.end&&G()}}else T=!0,i.currentTime<r.start-.5&&(i.currentTime=r.start)};r.destroy=function(){this.manualUpdate=!1,u=!1,s=!1,c&&e.clearInterval(c),b&&e.clearInterval(b),f&&e.clearTimeout(f),d&&e.clearInterval(d),_&&_.destroy(),_=null,i.removeEventListener("canplay",k),i.removeEventListener("canplaythrough",x),i.removeEventListener("loadeddata",k),i.removeEventListener("loadedmetadata",k),i.removeEventListener("progress",k),i.removeEventListener("ended",G),i.removeEventListener("stalled",z),this.off(),this.stop(),this.clear(),i=null,P=null},r.isLoaded=function(){return o};var O=function(){l||(l=!0,P.trigger(n.LOAD_STARTED),b=e.setInterval(U,1e3))},A=function(){P&&(-1==w&&(w=a?1:0),P.pause())},M=function(){P&&(0===w&&P.resume(),w=-1)},U=function(){var e=p[g];g?(i.currentTime<e.start-1||i.currentTime>e.end+1?(y+=1,Debug.warn("ScrubberOutOfRange: The scrubber position ("+i.currentTime+") is out of range ("+e.start+" - "+e.end+"). This warning reported "+y+" times."),y>=5&&(i.currentTime=e.start)):y=0,i.currentTime!==S?(E=0,S=i.currentTime):(E++,!a&&E>=5&&i.play())):(y=0,E=0)},k=function(){var r,a=0;if(i.buffered.length&&(a=i.buffered.end(i.buffered.length-1)),!l&&a>0&&i.duration>0&&O(),!o){if(r=Math.max(1,a/i.duration),isNaN(r))return;r!==h&&(h=r,P.trigger(n.LOAD_PROGRESS,h)),.001>1-r&&(s=!1,e.clearInterval(d),h=1,o=!0,p.silence!==t&&P.play("silence"),P.trigger(n.LOADED))}},I=function(){p[g]},x=function(){O()},z=function(){l||Debug.log("Media stalled before load started")},G=function(){var t=p[g];t&&t.loop?(P.pause(),i.currentTime=t.start,e.setTimeout(function(){P.trigger(n.PROGRESS,1),P.trigger(n.COMPLETE),g&&P.play(g)},0)):(P.stop(),P.trigger(n.PROGRESS,1),P.trigger(n.COMPLETE))};namespace("cloudkid").SwishSprite=n}(window),function(e,t){"use strict";var n={};n.importSpriteMap=function(e,r){if(r.resources===t)throw"Sprite configuration must contain 'resources': an array of file types";var i=n.getPlayableURL(r.resources);if(r.spritemap===t)throw"Sprite configuration must contain 'spritemap': a dictionary of audio sprites";var a,o;for(o in r.spritemap)a=r.spritemap[o],e.setSound(o,a.start,a.end-a.start,a.loop);return i},n.supported=function(){return r};var r=function(){var e=document.createElement("audio"),t=!1;try{t=!!e.canPlayType,t&&(t={},t.ogg=e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),t.oga=t.ogg,t.mp3=e.canPlayType("audio/mpeg;").replace(/^no$/,""),t.wav=e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),t.caf=e.canPlayType("audio/x-caf").replace(/^no$/,""),t.m4a=(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(n){}return t}();n.canPlayURL=function(e){if(!r)return!1;var t=e.toLowerCase().match(/\.([a-z0-9]{3})(\?.*)?$/i);return t&&t.length?(t=t[1],r[t]||!1):!1},n.getPlayableURL=function(e){var t,r,i=null;if(e instanceof Array){for(t=0,r=e.length;r>t;t++)if(e[t]instanceof Object){if(n.canPlayURL(e[t].url)){i=e[t].url;break}}else if(n.canPlayURL(e[t])){i=e[t];break}}else n.canPlayURL(e)&&(i=e);return i},namespace("cloudkid").AudioUtils=n}(window);