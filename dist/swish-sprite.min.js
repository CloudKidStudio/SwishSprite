!function(e,t,n){"use strict";var r=function(e,t){this.initialize(e,t)},i=r.prototype,a=null;i._onFocus=null,i._onBlur=null,i._onToggle=null,t.hidden!==n?a="visibilitychange":t.mozHidden!==n?a="mozvisibilitychange":t.msHidden!==n?a="msvisibilitychange":t.webkitHidden!==n&&(a="webkitvisibilitychange"),i.initialize=function(n,r){if(a){this._onBlur=r,this._onFocus=n;var i=function(){t.hidden||t.webkitHidden||t.msHidden||t.mozHidden?r():n()};t.addEventListener(a,i,!1),e.addEventListener("pagehide",r),e.addEventListener("pageshow",n),e.addEventListener("blur",r),e.addEventListener("focus",n),e.addEventListener("visibilitychange",i,!1),this._onToggle=i}},i.destroy=function(){a&&(e.removeEventListener("pagehide",this._onBlur),e.removeEventListener("pageshow",this._onFocus),e.removeEventListener("blur",this._onBlur),e.removeEventListener("focus",this._onFocus),e.addEventListener("visibilitychange",this._onToggle),t.removeEventListener(a,this._onToggle,!1),this._onFocus=null,this._onBlur=null)},namespace("cloudkid").PageVisibility=r}(window,document),function(e,t){"use strict";function n(e){return null===e?String(e):"object"==typeof e||"function"==typeof e?Object.prototype.toString.call(e).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof e}var r=function(){},i=r.prototype;i._listeners=[],i.trigger=function(e,n){if(this._listeners[e]!==t)for(var r=this._listeners[e],i=0;i<r.length;i++)r[i](n)},i.on=function(e,t){if("object"===n(e))for(var r in e)e.hasOwnProperty(r)&&this.on(r,e[r]);else if("function"===n(t))for(var i=e.split(" "),a=null,o=0,s=i.length;s>o;o++)a=i[o],this._listeners[a]=this._listeners[a]||[],-1===this._callbackIndex(a,t)&&this._listeners[a].push(t);else if("array"===n(t))for(var u=0,l=t.length;l>u;u++)this.on(e,t[u]);return this},i.off=function(e,r){if(e===t)this._listeners=[];else if("array"===n(r))for(var i=0,a=r.length;a>i;i++)this.off(e,r[i]);else for(var o=e.split(" "),s=null,u=0,l=o.length;l>u;u++)if(s=o[u],this._listeners[s]=this._listeners[s]||[],r===t)this._listeners[s].length=0;else{var c=this._callbackIndex(s,r);-1!==c&&this._listeners[e].splice(c,1)}return this},i._callbackIndex=function(e,t){for(var n=0,r=this._listeners[e].length;r>n;n++)if(this._listeners[e][n]===t)return n;return-1},namespace("cloudkid").EventDispatcher=r}(window),function(e,t){"use strict";var n={};n.importSpriteMap=function(e,r){if(r.resources===t)throw"Sprite configuration must contain 'resources': an array of file types";var i=n.getPlayableURL(r.resources);if(r.spritemap===t)throw"Sprite configuration must contain 'spritemap': a dictionary of audio sprites";var a,o;for(o in r.spritemap)a=r.spritemap[o],e.setSound(o,a.start,a.end-a.start,a.loop);return i},n.supported=function(){return r};var r=function(){var e=document.createElement("audio"),t=!1;try{t=!!e.canPlayType,t&&(t={},t.ogg=e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),t.oga=t.ogg,t.mp3=e.canPlayType("audio/mpeg;").replace(/^no$/,""),t.wav=e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),t.caf=e.canPlayType("audio/x-caf").replace(/^no$/,""),t.m4a=(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(n){}return t}();n.canPlayURL=function(e){if(!r)return!1;var t=e.toLowerCase().match(/\.([a-z0-9]{3})(\?.*)?$/i);return t&&t.length?(t=t[1],r[t]||!1):!1},n.getPlayableURL=function(e){var t,r,i=null;if(e instanceof Array){for(t=0,r=e.length;r>t;t++)if(e[t]instanceof Object){if(n.canPlayURL(e[t].url)){i=e[t].url;break}}else if(n.canPlayURL(e[t])){i=e[t];break}}else n.canPlayURL(e)&&(i=e);return i},namespace("cloudkid").AudioUtils=n}(window),function(e,t){"use strict";var n=cloudkid.EventDispatcher,r=cloudkid.PageVisibility,i=cloudkid.AudioUtils,a=function(e){this.initialize(e)},o=a.prototype=new n,s=null,u=!0,l=!1,c=!1,d=!1,f=!1,h=null,p=null,g=null,v=0,m=null,y=0,E=null,T=null,L=null,b=0,S=!1,P=null,_=null,w=null,D=null,R=null,O=-1,A=null;a.LOAD_STARTED="loadStarted",a.LOADED="loaded",a.LOAD_PROGRESS="loadProgress",a.COMPLETE="complete",a.PROGRESS="progress",a.PAUSED="paused",a.RESUMED="resumed",a.STOPPED="stopped",a.STARTED="started",a.M4A_PADDING=.1,a.VERSION="1.0.6",o.manualUpdate=!1,o.initialize=function(t){if(!i.supported())throw"HTML5 Audio is not supported!";if(null!==D)throw"SwishSprite instance is already create. Destroy before re-creating";this.clear();var n=null!==t&&"object"==typeof t?i.importSpriteMap(this,t):i.getPlayableURL(t);if(!n)throw"The supplied filetype is unsupported in this browser.";D=this,l=!1,u=!0,f=!1,b=0,S=!1,R=new r(I,k),O=-1,y=n.indexOf(".m4a")>-1?a.M4A_PADDING:0,s=e.document.createElement("audio"),s.addEventListener("canplay",z),s.addEventListener("canplaythrough",H),s.addEventListener("loadeddata",z),s.addEventListener("loadedmetadata",z),s.addEventListener("progress",z),s.addEventListener("ended",j),s.addEventListener("stalled",$),s.src=n},o.getAudioElement=function(){return s},o.mute=function(){return s.volume=0,this},o.unmute=function(){return s.volume=1,this},o.pause=function(){d=!1,h&&e.clearInterval(h),g&&e.clearTimeout(g);var t=u;return s.pause(),u=!0,t||this.trigger(a.PAUSED),this},o.resume=function(){return u&&E&&(this.play(E,s.currentTime),this.trigger(a.RESUMED)),this},o.stop=function(){return null!==E&&this.trigger(a.STOPPED),this.pause(),E=null,this},o.getLength=function(e){return e===t&&E!==t?m[E].duration:e!==t?m[e].duration:0},o.getPosition=function(){return E!==t&&m[E]!==t?s.currentTime-m[E].start:0},o.getSound=function(e){return e===t&&E!==t?m[E]:e?m[e]:void 0},o.setSound=function(e,t,n,r){var i=r?0:y;return m[e]={start:t-i,end:t+n+i,duration:n+2*i,loop:r},this},o.prepare=function(e){m[e]!==t&&(s.currentTime=m[e].start)},o.clear=function(){return m={},this},o.load=function(){try{if(p&&e.clearInterval(p),c=!0,this.manualUpdate||(p=e.setInterval(z,10)),m.silence===t)throw"'silence' audio is required";this.play("silence")}catch(n){}return this},o.update=function(){c&&z(),d&&M()},o.play=function(n,r){var i;if(L=0,d=!1,e.clearInterval(h),e.clearTimeout(g),m[n]===t)return Debug.error("SoundUnknown: Sound not found. Playing sound '"+n+"' has failed."),!1;var o=m[n];i=o.start,r!==t&&r>=o.start&&r<o.end&&(i=r);try{T=!1,s.pause(),P=s.currentTime;try{s.currentTime=A=i}catch(l){}if(Math.abs(s.currentTime-i)>.5)return!0;E=n,u=!1,s.play(),D.trigger(a.STARTED);var c=Math.max(0,Math.min((s.currentTime-m[E].start)/m[E].duration,1));D.trigger(a.PROGRESS,c),g=e.setTimeout(G,1e3*m[E].duration+500),d=!0,this.manualUpdate||(h=e.setInterval(M,10))}catch(l){return Debug.error("SoundPlayException: Sound Playback has failed: "+l),!1}return!0};var M=function(){var t,n=m[E];if(!T&&e.Math.abs(s.currentTime-P)>.1)T=!0,P=s.currentTime,g&&e.clearTimeout(g),t=n.end-s.currentTime,e.Math.abs(t-n.duration)>.1&&(t=n.duration),g=e.setTimeout(G,1e3*t+500);else if(S||s.currentTime===P){if(T&&S){if(s.currentTime>A){var r=Math.max(0,Math.min((s.currentTime-n.start)/n.duration,1));D.trigger(a.PROGRESS,r)}A=s.currentTime,s.currentTime>=n.end&&j()}}else S=!0,s.currentTime<n.start-.5&&(s.currentTime=n.start)};o.destroy=function(){this.manualUpdate=!1,d=!1,c=!1,h&&e.clearInterval(h),_&&e.clearInterval(_),g&&e.clearTimeout(g),p&&e.clearInterval(p),R&&R.destroy(),R=null,s.removeEventListener("canplay",z),s.removeEventListener("canplaythrough",H),s.removeEventListener("loadeddata",z),s.removeEventListener("loadedmetadata",z),s.removeEventListener("progress",z),s.removeEventListener("ended",j),s.removeEventListener("stalled",$),this.off(),this.stop(),this.clear(),s=null,D=null},o.isLoaded=function(){return l};var U=function(){f||(f=!0,D.trigger(a.LOAD_STARTED),_=e.setInterval(x,1e3))},k=function(){D&&(-1==O&&(O=u?1:0),D.pause())},I=function(){D&&(0===O&&D.resume(),O=-1)},x=function(){var e=m[E];E?(s.currentTime<e.start-1||s.currentTime>e.end+1?(L+=1,Debug.warn("ScrubberOutOfRange: The scrubber position ("+s.currentTime+") is out of range ("+e.start+" - "+e.end+"). This warning reported "+L+" times."),L>=5&&(s.currentTime=e.start)):L=0,s.currentTime!==w?(b=0,w=s.currentTime):(b++,!u&&b>=5&&s.play())):(L=0,b=0)},z=function(){var n,r=0;if(s.buffered.length&&(r=s.buffered.end(s.buffered.length-1)),!f&&r>0&&s.duration>0&&U(),!l){if(n=Math.max(1,r/s.duration),isNaN(n))return;n!==v&&(v=n,D.trigger(a.LOAD_PROGRESS,v)),.001>1-n&&(c=!1,e.clearInterval(p),v=1,l=!0,m.silence!==t&&D.play("silence"),D.trigger(a.LOADED))}},G=function(){m[E]},H=function(){U()},$=function(){f||Debug.log("Media stalled before load started")},j=function(){var t=m[E];t&&t.loop?(D.pause(),s.currentTime=t.start,e.setTimeout(function(){D.trigger(a.PROGRESS,1),D.trigger(a.COMPLETE),E&&D.play(E)},0)):(D.stop(),D.trigger(a.PROGRESS,1),D.trigger(a.COMPLETE))};namespace("cloudkid").SwishSprite=a}(window);