!function(e,t,n){"use strict";var r=function(e,t){this.initialize(e,t)},i=r.prototype,a=null;i._onFocus=null,i._onBlur=null,i._onToggle=null,t.hidden!==n?a="visibilitychange":t.mozHidden!==n?a="mozvisibilitychange":t.msHidden!==n?a="msvisibilitychange":t.webkitHidden!==n&&(a="webkitvisibilitychange"),i.initialize=function(n,r){if(a){this._onBlur=r,this._onFocus=n;var i=function(){t.hidden||t.webkitHidden||t.msHidden||t.mozHidden?r():n()};t.addEventListener(a,i,!1),e.addEventListener("pagehide",r),e.addEventListener("pageshow",n),e.addEventListener("blur",r),e.addEventListener("focus",n),e.addEventListener("visibilitychange",i,!1),this._onToggle=i}},i.destroy=function(){a&&(e.removeEventListener("pagehide",this._onBlur),e.removeEventListener("pageshow",this._onFocus),e.removeEventListener("blur",this._onBlur),e.removeEventListener("focus",this._onFocus),e.addEventListener("visibilitychange",this._onToggle),t.removeEventListener(a,this._onToggle,!1),this._onFocus=null,this._onBlur=null)},namespace("cloudkid").PageVisibility=r}(window,document),function(e,t){"use strict";function n(e){return null===e?String(e):"object"==typeof e||"function"==typeof e?Object.prototype.toString.call(e).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof e}var r=function(){},i=r.prototype;i._listeners=[],i.trigger=function(e,n){if(this._listeners[e]!==t)for(var r=this._listeners[e],i=0;i<r.length;i++)r[i](n)},i.on=function(e,t){if("object"===n(e))for(var r in e)e.hasOwnProperty(r)&&this.on(r,e[r]);else if("function"===n(t))for(var i=e.split(" "),a=null,o=0,s=i.length;s>o;o++)a=i[o],this._listeners[a]=this._listeners[a]||[],-1===this._callbackIndex(a,t)&&this._listeners[a].push(t);else if("array"===n(t))for(var u=0,l=t.length;l>u;u++)this.on(e,t[u]);return this},i.off=function(e,r){if(e===t)this._listeners=[];else if("array"===n(r))for(var i=0,a=r.length;a>i;i++)this.off(e,r[i]);else for(var o=e.split(" "),s=null,u=0,l=o.length;l>u;u++)if(s=o[u],this._listeners[s]=this._listeners[s]||[],r===t)this._listeners[s].length=0;else{var c=this._callbackIndex(s,r);-1!==c&&this._listeners[e].splice(c,1)}return this},i._callbackIndex=function(e,t){for(var n=0,r=this._listeners[e].length;r>n;n++)if(this._listeners[e][n]===t)return n;return-1},namespace("cloudkid").EventDispatcher=r}(window),function(e,t){"use strict";var n=function(e){this.initialize(e)},r=n.prototype=new cloudkid.EventDispatcher,i=null,a=!0,o=!1,s=!1,u=!1,l=!1,c=!1,d=null,f=null,h=null,p=0,g=null,m=0,v=null,y=null,E=null,T=0,b=!1,L=null,S=null,P=null,_=null,w=null,D=-1,R=null;n.LOAD_STARTED="loadStarted",n.LOADED="loaded",n.LOAD_PROGRESS="loadProgress",n.COMPLETE="complete",n.PROGRESS="progress",n.PAUSED="paused",n.RESUMED="resumed",n.STOPPED="stopped",n.STARTED="started",n.M4A_PADDING=.1,n.VERSION="1.0.4",r.manualUpdate=!1,r.initialize=function(t){var r=cloudkid.AudioUtils;if(!r.supported())throw"HTML5 Audio is not supported!";if(null!==_)throw"SwishSprite instance is already create. Destroy before re-creating";this.clear();var s=null!==t&&"object"==typeof t?r.importSpriteMap(this,t):r.getPlayableURL(t);if(!s)throw"The supplied filetype is unsupported in this browser.";_=this,l=!1,o=!1,a=!0,c=!1,T=0,b=!1,w=new cloudkid.PageVisibility(U,M),D=-1,m=s.indexOf(".m4a")>-1?n.M4A_PADDING:0,i=e.document.createElement("audio"),i.addEventListener("canplay",I),i.addEventListener("canplaythrough",z),i.addEventListener("loadeddata",I),i.addEventListener("loadedmetadata",I),i.addEventListener("progress",I),i.addEventListener("ended",H),i.addEventListener("stalled",G),i.src=s},r.getAudioElement=function(){return i},r.mute=function(){return i.volume=0,this},r.unmute=function(){return i.volume=1,this},r.pause=function(){u=!1,d&&e.clearInterval(d),h&&e.clearTimeout(h);var t=a;return i.pause(),a=!0,t||this.trigger(n.PAUSED),this},r.resume=function(){return a&&v&&(this.play(v,i.currentTime),this.trigger(n.RESUMED)),this},r.stop=function(){return null!==v&&this.trigger(n.STOPPED),this.pause(),v=null,this},r.getLength=function(e){return e===t&&v!==t?g[v].duration:e!==t?g[e].duration:0},r.getPosition=function(){return v!==t&&g[v]!==t?i.currentTime-g[v].start:0},r.getSound=function(e){return e===t&&v!==t?g[v]:e?g[e]:void 0},r.setSound=function(e,t,n,r){var i=r?0:m;return g[e]={start:t-i,end:t+n+i,duration:n+2*i,loop:r},this},r.prepare=function(e){g[e]!==t&&(i.currentTime=g[e].start)},r.clear=function(){return g={},this},r.load=function(){if(!l){l=!0;try{if(f&&e.clearInterval(f),s=!0,this.manualUpdate||(f=e.setInterval(I,10)),g.silence===t)throw"'silence' audio is required";this.play("silence")}catch(n){}}return this},r.update=function(){s&&I(),u&&O()},r.play=function(r,o){var s;if(E=0,u=!1,e.clearInterval(d),e.clearTimeout(h),g[r]===t)return Debug.error("SoundUnknown: Sound not found. Playing sound '"+r+"' has failed."),!1;var l=g[r];s=l.start,o!==t&&o>=l.start&&o<l.end&&(s=o);try{y=!1,i.pause(),L=i.currentTime;try{R=s,i.buffered&&i.buffered.length&&(i.currentTime=R)}catch(c){Debug.error("CurrentTimeSetException: Setting the current time has failed: "+c)}if(Math.abs(i.currentTime-s)>.5)return!0;v=r,a=!1,i.play(),_.trigger(n.STARTED);var f=Math.max(0,Math.min((i.currentTime-g[v].start)/g[v].duration,1));_.trigger(n.PROGRESS,f),h=e.setTimeout(x,1e3*g[v].duration+500),u=!0,this.manualUpdate||(d=e.setInterval(O,10))}catch(c){return Debug.error("SoundPlayException: Sound Playback has failed: "+c),!1}return!0};var O=function(){var t,r=g[v];if(!y&&e.Math.abs(i.currentTime-L)>.1)y=!0,L=i.currentTime,h&&e.clearTimeout(h),t=r.end-i.currentTime,e.Math.abs(t-r.duration)>.1&&(t=r.duration),h=e.setTimeout(x,1e3*t+500);else if(b||i.currentTime===L){if(y&&b){if(i.currentTime>R){var a=Math.max(0,Math.min((i.currentTime-r.start)/r.duration,1));_.trigger(n.PROGRESS,a)}R=i.currentTime,i.currentTime>=r.end&&H()}}else b=!0,i.currentTime<r.start-.5&&(i.currentTime=r.start)};r.destroy=function(){this.manualUpdate=!1,u=!1,s=!1,d&&e.clearInterval(d),S&&e.clearInterval(S),h&&e.clearTimeout(h),f&&e.clearInterval(f),w&&w.destroy(),w=null,i.removeEventListener("canplay",I),i.removeEventListener("canplaythrough",z),i.removeEventListener("loadeddata",I),i.removeEventListener("loadedmetadata",I),i.removeEventListener("progress",I),i.removeEventListener("ended",H),i.removeEventListener("stalled",G),this.off(),this.stop(),this.clear(),i=null,_=null},r.isLoaded=function(){return o};var A=function(){c||(c=!0,_.trigger(n.LOAD_STARTED),S=e.setInterval(k,1e3))},M=function(){_&&(-1==D&&(D=a?1:0),_.pause())},U=function(){_&&(0===D&&_.resume(),D=-1)},k=function(){var e=g[v];v?(i.currentTime<e.start-1||i.currentTime>e.end+1?(E+=1,Debug.warn("ScrubberOutOfRange: The scrubber position ("+i.currentTime+") is out of range ("+e.start+" - "+e.end+"). This warning reported "+E+" times."),E>=5&&(i.currentTime=e.start)):E=0,i.currentTime!==P?(T=0,P=i.currentTime):(T++,!a&&T>=5&&i.play())):(E=0,T=0)},I=function(){var r,a=0;if(i.buffered.length&&(a=i.buffered.end(i.buffered.length-1)),!c&&a>0&&i.duration>0&&A(),!o){if(r=Math.max(1,a/i.duration),isNaN(r))return;r!==p&&(p=r,_.trigger(n.LOAD_PROGRESS,p)),.001>1-r&&(s=!1,e.clearInterval(f),p=1,o=!0,g.silence!==t&&_.play("silence"),_.trigger(n.LOADED))}},x=function(){g[v]},z=function(){A()},G=function(){c||Debug.log("Media stalled before load started")},H=function(){var t=g[v];t&&t.loop?(_.pause(),i.currentTime=t.start,e.setTimeout(function(){_.trigger(n.PROGRESS,1),_.trigger(n.COMPLETE),v&&_.play(v)},0)):(_.stop(),_.trigger(n.PROGRESS,1),_.trigger(n.COMPLETE))};namespace("cloudkid").SwishSprite=n}(window),function(e,t){"use strict";var n={};n.importSpriteMap=function(e,r){if(r.resources===t)throw"Sprite configuration must contain 'resources': an array of file types";var i=n.getPlayableURL(r.resources);if(r.spritemap===t)throw"Sprite configuration must contain 'spritemap': a dictionary of audio sprites";var a,o;for(o in r.spritemap)a=r.spritemap[o],e.setSound(o,a.start,a.end-a.start,a.loop);return i},n.supported=function(){return r};var r=function(){var e=document.createElement("audio"),t=!1;try{t=!!e.canPlayType,t&&(t={},t.ogg=e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),t.oga=t.ogg,t.mp3=e.canPlayType("audio/mpeg;").replace(/^no$/,""),t.wav=e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),t.caf=e.canPlayType("audio/x-caf").replace(/^no$/,""),t.m4a=(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(n){}return t}();n.canPlayURL=function(e){if(!r)return!1;var t=e.toLowerCase().match(/\.([a-z0-9]{3})(\?.*)?$/i);return t&&t.length?(t=t[1],r[t]||!1):!1},n.getPlayableURL=function(e){var t,r,i=null;if(e instanceof Array){for(t=0,r=e.length;r>t;t++)if(e[t]instanceof Object){if(n.canPlayURL(e[t].url)){i=e[t].url;break}}else if(n.canPlayURL(e[t])){i=e[t];break}}else n.canPlayURL(e)&&(i=e);return i},namespace("cloudkid").AudioUtils=n}(window);